<controls:UserControl
  x:Class="Synthesis.Feature.Passive.PassiveEditorView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:prism="http://prismlibrary.com/"
  xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
  xmlns:core="clr-namespace:Synthesis.Core"
  prism:ViewModelLocator.AutoWireViewModel="True"
  TextElement.Foreground="{DynamicResource MaterialDesignBody}"
  xmlns:controls="clr-namespace:System.Windows.Controls;assembly=PresentationFramework">
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition
        Width="260" />
      <ColumnDefinition
        Width="*" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition
        Height="Auto" />
      <RowDefinition
        Height="*" />
    </Grid.RowDefinitions>
    <Border
      Grid.Row="0"
      Grid.ColumnSpan="2"
      Background="{DynamicResource MaterialDesignPaper}"
      BorderBrush="{DynamicResource MaterialDesignDivider}"
      BorderThickness="0,0,0,1"
      Padding="8,4">
      <StackPanel
        Orientation="Horizontal">
        <Button
          Content="âž• æ–°å»ºè¢«åŠ¨"
          Style="{StaticResource MaterialDesignRaisedButton}"
          Margin="0,0,10,0"
          Padding="12,6"
          Command="{Binding CreateCommand}"
          IsEnabled="{Binding Manager.PassiveRepo.HasModData}" />
        <Button
          Content="ðŸ—‘ï¸ åˆ é™¤è¢«åŠ¨"
          Style="{StaticResource MaterialDesignOutlinedButton}"
          Foreground="#FF5252"
          BorderBrush="#FF5252"
          Padding="12,6"
          Margin="0,0,10,0"
          Command="{Binding DeleteCommand}" />
      </StackPanel>
    </Border>
    <DockPanel
      Grid.Row="1"
      Grid.Column="0">
      <TextBox
        x:Name="SearchBox"
        DockPanel.Dock="Top"
        Margin="4"
        Padding="4"
        materialDesign:HintAssist.Hint="æœç´¢ ID æˆ– åç§°..."
        Style="{StaticResource MaterialDesignOutlinedTextBox}"
        TextChanged="SearchBox_TextChanged" />
      <ListBox
        x:Name="PassiveListBox"
        VirtualizingPanel.IsVirtualizing="True"
        VirtualizingPanel.VirtualizationMode="Recycling"
        DisplayMemberPath="DisplayName"
        BorderThickness="0,1,1,0"
        BorderBrush="{DynamicResource MaterialDesignDivider}"
        ItemsSource="{Binding Manager.PassiveRepo.Items}"
        SelectedItem="{Binding SelectedItem}" />
    </DockPanel>
    <ScrollViewer
      Grid.Row="1"
      Grid.Column="1"
      VerticalScrollBarVisibility="Auto">
      <StackPanel
        x:Name="EditPanel"
        Margin="30"
        DataContext="{Binding SelectedItem}">
        <FrameworkElement.Style>
          <Style
            TargetType="{x:Type StackPanel}">
            <Setter
              Property="Visibility"
              Value="Visible" />
            <Style.Triggers>
              <DataTrigger
                Binding="{Binding}"
                Value="{x:Null}">
                <Setter
                  Property="Visibility"
                  Value="Hidden" />
              </DataTrigger>
              <DataTrigger
                Value="True"
                Binding="{Binding IsVanilla}">
                <Setter
                  Property="IsEnabled"
                  Value="False" />
                <Setter
                  Property="UIElement.Opacity"
                  Value="0.6" />
              </DataTrigger>
            </Style.Triggers>
          </Style>
        </FrameworkElement.Style>
        <TextBlock
          Text="è¢«åŠ¨èƒ½åŠ›ç¼–è¾‘ (Passive)"
          FontSize="22"
          FontWeight="Bold"
          Margin="0,0,0,25" />
        <Expander
          Header="âš™ï¸ åŸºç¡€å‚æ•° (Data)"
          IsExpanded="True"
          Margin="0,0,0,15">
          <StackPanel
            Margin="0,15,0,0">
            <Grid
              Margin="0,0,0,20">
              <Grid.ColumnDefinitions>
                <ColumnDefinition
                  Width="1.5*" />
                <ColumnDefinition
                  Width="20" />
                <ColumnDefinition
                  Width="*" />
              </Grid.ColumnDefinitions>
              <TextBox
                Grid.Column="0"
                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                materialDesign:HintAssist.Hint="ID"
                Text="{Binding Id, UpdateSourceTrigger=PropertyChanged}" />
              <TextBox
                Grid.Column="2"
                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                materialDesign:HintAssist.Hint="Cost (è´¹ç”¨)"
                Text="{Binding Cost, UpdateSourceTrigger=PropertyChanged}" />
            </Grid>
            <Grid
              Margin="0,0,0,20">
              <Grid.ColumnDefinitions>
                <ColumnDefinition
                  Width="*" />
                <ColumnDefinition
                  Width="20" />
                <ColumnDefinition
                  Width="*" />
              </Grid.ColumnDefinitions>
              <ComboBox
                Grid.Column="0"
                ItemsSource="{x:Static core:GlobalValues.Rarities}"
                Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                materialDesign:HintAssist.Hint="Rarity (ç¨€æœ‰åº¦)"
                SelectedItem="{Binding Rarity, UpdateSourceTrigger=PropertyChanged}" />
              <CheckBox
                Grid.Column="2"
                Content="å¯å½’å±ž (CanGivePassive)"
                Style="{StaticResource MaterialDesignSecondaryCheckBox}"
                VerticalAlignment="Bottom"
                Margin="0,0,0,5"
                IsChecked="{Binding CanGivePassive, UpdateSourceTrigger=PropertyChanged}" />
            </Grid>
            <Grid
              Margin="0,0,0,10">
              <Grid.ColumnDefinitions>
                <ColumnDefinition
                  Width="*" />
                <ColumnDefinition
                  Width="20" />
                <ColumnDefinition
                  Width="2*" />
              </Grid.ColumnDefinitions>
              <TextBox
                Grid.Column="0"
                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                materialDesign:HintAssist.Hint="InnerType (äº’æ–¥ç»„ID)"
                ToolTip="-1 è¡¨ç¤ºæ— é™åˆ¶ï¼›ç›¸åŒæ­£æ•´æ•° ID çš„è¢«åŠ¨ä¸èƒ½åŒæ—¶è£…å¤‡"
                Text="{Binding InnerTypeId, UpdateSourceTrigger=PropertyChanged}" />
              <ComboBox
                Grid.Column="2"
                IsEditable="True"
                Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                materialDesign:HintAssist.Hint="Script (è„šæœ¬ç±»å)"
                ToolTip="é€šå¸¸ç•™ç©ºï¼Œé™¤éžä½ æœ‰è‡ªå®šä¹‰C#ä»£ç "
                Text="{Binding Script, UpdateSourceTrigger=PropertyChanged}"
                ItemsSource="{Binding DataContext.Manager.ScriptScanner.PassiveScripts, RelativeSource={RelativeSource AncestorType=UserControl}}" />
            </Grid>
          </StackPanel>
        </Expander>
        <Expander
          Header="ðŸ“ æœ¬åœ°åŒ–æ–‡æœ¬ (Localization)"
          IsExpanded="True"
          Margin="0,0,0,15">
          <StackPanel
            Margin="0,15,0,0">
            <TextBox
              Style="{StaticResource MaterialDesignFloatingHintTextBox}"
              materialDesign:HintAssist.Hint="Name (æ˜¾ç¤ºåç§°)"
              Margin="0,0,0,20"
              Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" />
            <TextBox
              Height="120"
              AcceptsReturn="True"
              TextWrapping="Wrap"
              VerticalScrollBarVisibility="Auto"
              Style="{StaticResource MaterialDesignOutlinedTextBox}"
              materialDesign:HintAssist.Hint="Desc (èƒ½åŠ›æè¿°)"
              Padding="10"
              Text="{Binding Desc, UpdateSourceTrigger=PropertyChanged}" />
          </StackPanel>
        </Expander>
        <TextBlock
          Height="50" />
      </StackPanel>
    </ScrollViewer>
  </Grid>
</controls:UserControl>
