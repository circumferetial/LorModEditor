<UserControl x:Class="Synthesis.Feature.SkinEditor.SkinEditorView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             prism:ViewModelLocator.AutoWireViewModel="True"
             TextElement.Foreground="{DynamicResource MaterialDesignBody}">
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="280" />
      <ColumnDefinition Width="*" />
      <ColumnDefinition Width="300" />
    </Grid.ColumnDefinitions>
    <Grid Column="0" Background="{DynamicResource MaterialDesignPaper}">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>
      <StackPanel Grid.Row="0" Margin="10">
        <TextBlock Text="Skin (çš®è‚¤)" FontWeight="Bold" Margin="0,0,0,5"
                   Foreground="{DynamicResource PrimaryHueMidBrush}" />
        <ComboBox Name="SkinListBox" DisplayMemberPath="DisplayName"
                  Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                  materialDesign:HintAssist.Hint="é€‰æ‹©å½“å‰ç¼–è¾‘çš„çš®è‚¤..." Margin="0,0,0,10"
                  ItemsSource="{Binding Manager.SkinRepo.Items}" SelectedItem="{Binding SelectedItem}" />
        <StackPanel Orientation="Horizontal">
          <Button Content="âž• æ–°å»ºçš®è‚¤" Style="{StaticResource MaterialDesignRaisedButton}" Margin="0,0,5,0"
                  Command="{Binding CreateCommand}" />
          <Button Content="ðŸ—‘ åˆ é™¤çš®è‚¤" Style="{StaticResource MaterialDesignOutlinedButton}" Foreground="#FF5252"
                  BorderBrush="#FF5252" Command="{Binding DeleteSkinCommand}" />
        </StackPanel>
        <TextBlock Margin="0,10,0,0" FontSize="11" Opacity="0.75" TextWrapping="Wrap"
                   Text="{Binding PublishCompatibilityText}" />
        <Separator Background="{DynamicResource MaterialDesignDivider}" Margin="0,15" />
      </StackPanel>
      <DockPanel Grid.Row="1" Margin="10,0,10,10">
        <Grid DockPanel.Dock="Top" Margin="0,0,0,10">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>
          <TextBlock Grid.Row="0" Text="Actions (åŠ¨ä½œåºåˆ—)" VerticalAlignment="Center" FontWeight="Bold" />
          <WrapPanel Grid.Row="1" Margin="0,8,0,0">
            <ComboBox Width="120" Margin="0,0,5,5" Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                      materialDesign:HintAssist.Hint="æžšä¸¾åŠ¨ä½œ" ItemsSource="{Binding PresetActions}"
                      SelectedItem="{Binding SelectedPresetAction, UpdateSourceTrigger=PropertyChanged}" />
            <Button Content="âž• æžšä¸¾åŠ¨ä½œ" Margin="0,0,5,5" Style="{StaticResource MaterialDesignOutlinedButton}"
                    Padding="8,4" Height="28" FontSize="12" Command="{Binding AddPresetActionCommand}" />
            <Button Content="âœï¸ è‡ªå®šä¹‰åŠ¨ä½œ" Margin="0,0,5,5" Visibility="Collapsed"
                    Style="{StaticResource MaterialDesignOutlinedButton}" Padding="8,4" Height="28" FontSize="12"
                    Command="{Binding AddCustomActionCommand}" />
            <Button Content="ðŸ—‘ åˆ é™¤åŠ¨ä½œ" Margin="0,0,5,5" Style="{StaticResource MaterialDesignOutlinedButton}"
                    Foreground="#FF5252" BorderBrush="#FF5252" Padding="8,4" Height="28" FontSize="12"
                    Command="{Binding DeleteActionCommand}" />
          </WrapPanel>
        </Grid>
        <ListBox Name="ActionList" Style="{StaticResource MaterialDesignOutlinedListBox}" Background="#00FFFFFF"
                 Padding="0" ItemsSource="{Binding SelectedItem.Actions}" SelectedItem="{Binding SelectedAction}"
                 SelectionChanged="ActionList_SelectionChanged">
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Border Padding="10,8" Background="#00FFFFFF" BorderBrush="{DynamicResource MaterialDesignDivider}"
                      BorderThickness="0,0,0,1">
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>
                  <materialDesign:PackIcon Kind="MovieOpen" Opacity="0.5" VerticalAlignment="Center" Margin="0,0,10,0" />
                  <TextBlock Grid.Column="1" VerticalAlignment="Center" Text="{Binding ActionName}" />
                </Grid>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ListBox>
      </DockPanel>
    </Grid>
    <Border Grid.Column="1" Background="#1E1E1E" ClipToBounds="True">
      <Grid>
        <Canvas>
          <Panel.Background>
            <DrawingBrush TileMode="Tile" Viewport="0,0,40,40" ViewportUnits="Absolute" Opacity="0.05">
              <DrawingBrush.Drawing>
                <GeometryDrawing>
                  <GeometryDrawing.Geometry>
                    <GeometryGroup>
                      <LineGeometry StartPoint="0,0" EndPoint="0,40" />
                      <LineGeometry StartPoint="0,0" EndPoint="40,0" />
                    </GeometryGroup>
                  </GeometryDrawing.Geometry>
                  <GeometryDrawing.Pen>
                    <Pen Brush="#FFFFFFFF" Thickness="1" />
                  </GeometryDrawing.Pen>
                </GeometryDrawing>
              </DrawingBrush.Drawing>
            </DrawingBrush>
          </Panel.Background>
        </Canvas>
        <Canvas Name="ViewportCanvas" Background="#00FFFFFF" MouseWheel="Viewport_MouseWheel"
                MouseRightButtonDown="Viewport_MouseRightDown" MouseRightButtonUp="Viewport_MouseRightUp"
                MouseMove="Viewport_MouseMove">
          <Canvas Name="WorldCanvas">
            <UIElement.RenderTransform>
              <TransformGroup>
                <ScaleTransform x:Name="ViewScale" ScaleX="1" ScaleY="1" />
                <TranslateTransform x:Name="ViewTranslate" X="400" Y="300" />
              </TransformGroup>
            </UIElement.RenderTransform>
            <Line X1="-10000" Y1="0" X2="10000" Y2="0" Stroke="#00E676" StrokeThickness="2" Opacity="0.8"
                  IsHitTestVisible="False" />
            <Line X1="0" Y1="-10000" X2="0" Y2="10000" Stroke="#00E676" StrokeThickness="1" Opacity="0.4"
                  IsHitTestVisible="False" StrokeDashArray="4 4" />
            <Image Name="BodyImage" Stretch="Fill" RenderOptions.BitmapScalingMode="NearestNeighbor" Cursor="SizeAll"
                   MouseLeftButtonDown="Body_MouseDown" MouseLeftButtonUp="Body_MouseUp">
              <UIElement.Effect>
                <DropShadowEffect ShadowDepth="0" BlurRadius="10" Opacity="0.2" />
              </UIElement.Effect>
            </Image>
            <Grid Name="HeadPoint" Width="14" Height="14" Cursor="Hand"
                  Visibility="{Binding SelectedAction.HeadEnable, Converter={StaticResource BoolToVis}}"
                  MouseLeftButtonDown="Head_MouseDown" MouseLeftButtonUp="Head_MouseUp">
              <Ellipse Fill="#FF5252" Stroke="#FFFFFFFF" StrokeThickness="2">
                <UIElement.Effect>
                  <DropShadowEffect ShadowDepth="0" Color="Red" BlurRadius="8" />
                </UIElement.Effect>
              </Ellipse>
            </Grid>
          </Canvas>
        </Canvas>
        <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="20" Opacity="0.6"
                    IsHitTestVisible="False">
          <TextBlock Text="ðŸ–±ï¸ å³é”®æ‹–æ‹½ç§»åŠ¨è§†è§’" Foreground="#FFFFFFFF" FontSize="11" HorizontalAlignment="Right" />
          <TextBlock Text="ðŸ–±ï¸ æ»šè½®ç¼©æ”¾ç”»å¸ƒ" Foreground="#FFFFFFFF" FontSize="11" HorizontalAlignment="Right" />
          <TextBlock Text="ðŸ–±ï¸ å·¦é”®æ‹–åŠ¨å›¾ç‰‡/çº¢ç‚¹" Foreground="#FFFFFFFF" FontSize="11" HorizontalAlignment="Right" />
        </StackPanel>
      </Grid>
    </Border>
    <Border Grid.Column="2" Background="{DynamicResource MaterialDesignPaper}"
            BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="1,0,0,0">
      <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="20" DataContext="{Binding SelectedAction}">
          <FrameworkElement.Style>
            <Style TargetType="{x:Type StackPanel}">
              <Setter Property="Visibility" Value="Visible" />
              <Style.Triggers>
                <DataTrigger Binding="{Binding}" Value="{x:Null}">
                  <Setter Property="Visibility" Value="Hidden" />
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </FrameworkElement.Style>
          <TextBlock Text="Action Properties" FontSize="20" FontWeight="Bold" Margin="0,0,0,20" />
          <Grid Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*" />
              <ColumnDefinition Width="10" />
              <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Button Grid.Column="0" Style="{StaticResource MaterialDesignOutlinedButton}" Height="50"
                    BorderBrush="{DynamicResource PrimaryHueMidBrush}"
                    Foreground="{DynamicResource PrimaryHueMidBrush}"
                    Command="{Binding DataContext.ImportImageCommand, RelativeSource={RelativeSource AncestorType=UserControl}}">
              <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="ImagePlus" Margin="0,0,10,0" />
                <TextBlock Text="å¯¼å…¥å›¾ç‰‡" FontWeight="Bold" />
              </StackPanel>
            </Button>
            <Button Grid.Column="2" Style="{StaticResource MaterialDesignOutlinedButton}" Height="50" Width="50"
                    ToolTip="æ°´å¹³é•œåƒç¿»è½¬å›¾ç‰‡ (Flip Horizontal)" BorderBrush="#FFFF4500" Foreground="#FFFF4500"
                    Command="{Binding DataContext.MirrorImageCommand, RelativeSource={RelativeSource AncestorType=UserControl}}">
              <materialDesign:PackIcon Kind="FlipHorizontal" Width="24" Height="24" />
            </Button>
          </Grid>
          <materialDesign:Card Background="#1AFFFFFF" Padding="15" UniformCornerRadius="8" Margin="0,0,0,20"
                               materialDesign:ElevationAssist.Elevation="Dp0">
            <StackPanel>
              <DockPanel LastChildFill="False">
                <TextBlock Text="âœ¨ Extended æ¨¡å¼" FontWeight="Bold" VerticalAlignment="Center" />
                <ToggleButton DockPanel.Dock="Right" Style="{StaticResource MaterialDesignSwitchToggleButton}"
                              ToolTip="å¼€å¯ ModInfo Extended='true'"
                              IsChecked="{Binding DataContext.SelectedItem.IsExtended, RelativeSource={RelativeSource AncestorType=UserControl}}" />
              </DockPanel>
              <TextBlock Text="ON: å¯ç”¨é«˜æ¸…/ç‰¹æ•ˆ/è‡ªå®šä¹‰å°ºå¯¸&#xA;OFF: å¼ºåˆ¶åŽŸç‰ˆå…¼å®¹ (512px, SD)" FontSize="10" Opacity="0.5"
                         Margin="0,5,0,0" TextWrapping="Wrap" />
            </StackPanel>
          </materialDesign:Card>
          <Expander Header="ðŸ“ æ‰©å±•å‚æ•° (Size/Quality)" IsExpanded="True" Margin="0,0,0,10"
                    IsEnabled="{Binding DataContext.SelectedItem.IsExtended, RelativeSource={RelativeSource AncestorType=UserControl}}">
            <StackPanel Margin="0,10,0,0">
              <TextBlock Text="âš ï¸ ä¿®æ”¹æ­¤å¤„ä¼šå½±å“å•ä½æ¯”ä¾‹ä¸Žå¤´éƒ¨åæ ‡æ¢ç®—" Foreground="#FFFFA500" FontSize="11" Margin="0,0,0,10" />
              <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition Width="10" />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <TextBox Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                         materialDesign:HintAssist.Hint="Size X (å®½)"
                         Text="{Binding SizeX, UpdateSourceTrigger=PropertyChanged}" />
                <TextBox Grid.Column="2" Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                         materialDesign:HintAssist.Hint="Size Y (é«˜)"
                         Text="{Binding SizeY, UpdateSourceTrigger=PropertyChanged}" />
              </Grid>
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                         materialDesign:HintAssist.Hint="Quality (PPUç¼©æ”¾)"
                         Text="{Binding Quality, UpdateSourceTrigger=PropertyChanged}" />
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Bottom">
                  <Button Content="SD(50)" CommandParameter="50" Style="{StaticResource MaterialDesignFlatButton}"
                          Padding="4,0" Height="24" FontSize="10" Margin="5,0,0,0"
                          Command="{Binding DataContext.SetQualityCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                  <Button Content="HD(100)" CommandParameter="100" Style="{StaticResource MaterialDesignFlatButton}"
                          Padding="4,0" Height="24" FontSize="10"
                          Command="{Binding DataContext.SetQualityCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                </StackPanel>
              </Grid>
              <TextBlock Text="* 50 = åŽŸç‰ˆ2å€ç¼©æ”¾ (SD)&#xA;* 100 = 1å€æ— ç¼©æ”¾ (HD)&#xA;* Quality ä¸å½±å“èº«ä½“ Pivot å¯¹åœ°é¢åŸºå‡†" FontSize="10"
                         Opacity="0.5" Margin="0,5,0,0" />
            </StackPanel>
          </Expander>
          <Expander Header="ðŸ“ èº«ä½“ä¸­å¿ƒ (Pivot)" IsExpanded="True" Margin="0,0,0,10">
            <StackPanel Margin="0,10,0,0">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition Width="15" />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <TextBox Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                         materialDesign:HintAssist.Hint="Pivot X (å·¦å³)"
                         Text="{Binding PivotX, UpdateSourceTrigger=PropertyChanged}" />
                <TextBox Grid.Column="2" Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                         materialDesign:HintAssist.Hint="Pivot Y (ä¸Šä¸‹)"
                         Text="{Binding PivotY, UpdateSourceTrigger=PropertyChanged}" />
              </Grid>
              <TextBlock Text="* ç»¿çº¿ä¸ºåœ°é¢ï¼Œè¯·è°ƒæ•´ Y å€¼ä½¿è„šåº•å¯¹é½ç»¿çº¿&#xA;* Pivot ä¸Ž Quality æ— å…³" FontSize="10" Opacity="0.5"
                         Margin="0,5,0,0" TextWrapping="Wrap" />
            </StackPanel>
          </Expander>
          <Expander Header="ðŸ™† å¤´éƒ¨æŒ‚è½½ (Head)" IsExpanded="True">
            <StackPanel Margin="0,10,0,0">
              <CheckBox Content="å¯ç”¨å¤´éƒ¨æŒ‚è½½ç‚¹" Style="{StaticResource MaterialDesignSecondaryCheckBox}" Margin="0,0,0,15"
                        IsChecked="{Binding HeadEnable}" />
              <StackPanel Visibility="{Binding HeadEnable, Converter={StaticResource BoolToVis}}">
                <Grid Margin="0,0,0,15">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="15" />
                    <ColumnDefinition />
                  </Grid.ColumnDefinitions>
                  <TextBox Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                           materialDesign:HintAssist.Hint="Head X"
                           Text="{Binding HeadX, UpdateSourceTrigger=PropertyChanged}" />
                  <TextBox Grid.Column="2" Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                           materialDesign:HintAssist.Hint="Head Y"
                           Text="{Binding HeadY, UpdateSourceTrigger=PropertyChanged}" />
                </Grid>
                <TextBox Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                         materialDesign:HintAssist.Hint="Rotation (è§’åº¦)"
                         Text="{Binding HeadRotation, UpdateSourceTrigger=PropertyChanged}" />
                <TextBlock Text="* æ‹–æ‹½ç”»å¸ƒä¸­çš„çº¢ç‚¹å¯ç›´æŽ¥è°ƒæ•´ä½ç½®" FontSize="10" Opacity="0.5" Margin="0,5,0,0" />
                <TextBlock
                  Text="* Face å›žé€€æç¤ºï¼šFire/Aim/Special/S1-S5/Slash2 åœ¨éƒ¨åˆ†åœºæ™¯ä¼šå›žé€€åˆ° Slashï¼›Penetrate2 å›žé€€åˆ° Penetrateï¼›Hit2 å›žé€€åˆ° Hit"
                  FontSize="10" Opacity="0.5" Margin="0,3,0,6" TextWrapping="Wrap" />
                <Grid Margin="0,0,0,20">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>
                  <materialDesign:PackIcon Kind="FaceManProfile" VerticalAlignment="Center" Margin="0,0,10,0"
                                           Opacity="0.5" />
                  <ComboBox Grid.Column="1" Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                            materialDesign:HintAssist.Hint="é¢éƒ¨æœå‘ (Direction)"
                            Text="{Binding Direction, UpdateSourceTrigger=PropertyChanged}">
                    <ComboBoxItem Content="Front" ToolTip="æ­£è„¸ (é»˜è®¤)" />
                    <ComboBoxItem Content="Side" ToolTip="ä¾§è„¸ (æˆ˜æ–—å§¿æ€å¸¸ç”¨)" />
                  </ComboBox>
                </Grid>
              </StackPanel>
            </StackPanel>
          </Expander>
        </StackPanel>
      </ScrollViewer>
    </Border>
  </Grid>
</UserControl>
